# RFID\_防碰撞算法\_信源编码\_差错控制\_系统调制\_S50\_无源标签\_工作频率\_自动识别\_RFID应用

## 防碰撞算法

### ALOHA算法

ALOHA算法是一种随机接入方法，其基本思想是采取标签先发言的方式，当标签进入读写器的识别区域内时就自动向读写器发送其自身的ID号，在标签发送数据的过程中，若有其他标签也在发送数据，将会发生信号重叠，从而导致冲突。读写器检测接收到的信号有无冲突，一旦发生冲突，读写器就发送命令让标签停止发送，随机等待一段时间后再重新发送以减少冲突。

### 纯ALOHA算法

在纯ALOHA算法中，若读写器检测出信号存在相互干扰，读写器就会以向电子标签发出命令，令其停止向读写器传输信号；电子标签在接收到命令信号之后，就会停止发送信息，并会在接下来的一个随机时间段内进入到待命状态，只有当该时间段过去后，才会重新向读写器发送信息。各个电子标签待命时间片段长度是随机的，再次向读写器发送信号的时间也不相同，这样减少碰撞的可能性。

纯ALOHA算法虽然算法简单，易于实现。但对于同一个标签，如果连续多次发生碰撞，这将导致读写器出现错误判断认为这个标签不在自己的作用范围内，同时其冲突概率很大。

### 时隙ALOHA算法

 时隙ALOHA算法把时间分成多个离散的时隙，每个时隙长度等于或稍大于一个帧，标签只能在每个时隙的开始处发送数据。这样标签要么成功发送，要么完全碰撞，避免了纯ALOHA算法中的部分碰撞冲突，碰撞周期减半，提高了信道利用率。时隙ALOHA算法需要读写器对其识别区域内的标签校准时间。时隙ALOHA算法是随机询问驱动的TDMA防冲撞算法。

<img src="https://chuantaoli.oss-cn-beijing.aliyuncs.com/image-20240617191107394.png" alt="image-20240617191107394" style="zoom:50%;" />

#### 图1 时隙ALOHA算法示意图

因为标签仅仅在确定的时隙中传输数据，所以该算法的冲撞发生频率仅仅是纯ALOHA算法的一半，但其系统的数据吞吐性能却会增加一倍。

### 帧时隙ALOHA算法

帧时隙算法中，时间被分成多个离散时隙，电子标签必须在时隙开始处才可以开始传输信息。读写器以一个帧为周期发送查询命令。当电子标签接收到读写器的请求命令时，每个标签通过随机挑选一个时隙发送信息给读写器。如果一个时隙只被唯一标签选中，则此时隙中标签传输的信息被读写器成功接收，标签被正确识别。如果有两个或两个以上的标签选择了同一时隙发送，则就会产生冲突，这些同时发送信息的标签就不能被读写器成功识别。整个算法的识别过程都会如此循环，一直到所有标签都被识别完成。

该算法的缺点是当标签数量远大于时隙个数时，读取标签的时间会大大增加；当标签个数远小于时隙个数时，会造成时隙浪费。

<img src="https://chuantaoli.oss-cn-beijing.aliyuncs.com/image-20240617191512854.png" alt="image-20240617191512854" style="zoom: 33%;" />

#### 图2 帧时隙ALOHA算法

如图2所示，阅读器首先在第一帧内发送请求，5个标签随机选择时隙进行数据发送。可知标签1和标签3均选择时隙1，因此碰撞；标签2和标签4均选择时隙2，因此碰撞；而标签5选择时隙3，发送成功。在第二个帧中，阅读器又先发送请求，剩下的4个标签随机选择时隙进行数据发送。可知标签1和标签4均选择时隙2，因此碰撞；标签2选择时隙3，成功发送；标签3选择时隙1，成功发送。

### 动态帧时隙ALOHA算法

动态帧时隙ALOHA算法中一个帧内的时隙数目随着区域内标签数目动态改变，或增加时隙数以减少帧中的碰撞数目。步骤如下：

1. 进入识别状态，开始识别命令中包含了初始的时隙数$N$。
2. 由电子标签随机选择一个时隙，同时将自己的时隙计数器复位为1。
3. 当电子标签随机选择的时隙数与时隙计数器对应时，标签向读写器发送数据；若不相等，标签将保留自己的时隙数并等待下一个命令。
4. 当读写器检测到的时隙数量等于命令中规定的循环长度N时，本次循环结束，读写器转入步骤2，开始新的循环。

举一个例子用大白话解释。假设初始时隙数 N=4N = 4N=4，并且有3个电子标签参与通信：

1. 初始化。阅读器发送识别命令，指定时隙数$N=4$，每个电子标签随机选择一个时隙：标签A选择时隙3、标签B选择时隙1、标签C选择时隙3。
2. 时隙1：时隙计数器此时为1，标签B的选择时隙等于当前时隙计数器，因此标签B发送数据，标签A和标签C等待下一个时隙。
3. 时隙2：时隙计数器此时为2，没有标签选择时隙2，因此没有数据发送。
4. 时隙3：时隙计数器此时为3，标签A和标签C都选择了时隙3，发生碰撞，因此标签A和标签C都未成功发送数据。
5. 时隙4：时隙计数器此时为4，没有标签选择时隙4，因此没有数据发送。
6. 读写器检测到时隙数量达到$N=4$，本次循环结束。读写器转入新的循环，可以指定不同的时隙数，转入步骤2。

动态帧时隙ALOHA算法允许根据系统的需要动态地调整帧长度，由于读写器作用范围内的标签数量是未知的，而且在识别的过程中未被识别的标签数目是改变的，因此，如何估算标签数量以及合理地调整帧长度成为动态帧时隙ALOHA算法的关键。由理论推导可知，在标签数目和帧长度接近的情况下，系统的识别效率最高，也就是说标签的值就是帧长度的最佳选择。

在实际应用中，动态帧时隙算法是在每帧结束后，根据上一帧的反馈情况检测标签发生碰撞的次数（碰撞时隙数），电子标签被成功识别的次数（成功时隙数）和电子标签在某个时隙没有返回数据信息的次数（空闲时隙数）来估计当前未被正确识别的电子标签数目，然后选择最佳的下一帧的长度，把它的帧长度作为下一轮识别的帧长，直到读写器工作范围内的电子标签全部识别完毕。

## 二进制树型搜索算法

二进制树型搜索算法由读写器控制，基本思想是不断的将导致碰撞的电子标签进行划分，缩小下一步搜索的标签数量，直到只有一个电子标签进行回应。选用曼彻斯特编码可实现“二进制树型搜索”算法。

<img src="https://chuantaoli.oss-cn-beijing.aliyuncs.com/image-20240617192513434.png" alt="image-20240617192513434" style="zoom: 33%;" />

#### 图3 二进制树型搜索算法过程

如图3所示，下面分析二进制树型搜索算法的过程：

1. 阅读器发送请求给电子标签，其中包含一个最大值，表示当前搜索范围的上限（11111111），即请求8位二进制数不大于11111111的所有标签响应。
2. 每个标签都根据自己的ID与请求中的掩码进行匹配。如果匹配成功，则发送自己的ID。在第一轮中，所有标签都匹配“11111111”，因此所有标签都尝试在同一时刻发送，这也就导致了冲突。
3. 第一次选择代：阅读器接收到多个标签的响应，检测到冲突。于是阅读器发出新的请求，限定范围更小。即请求限制“<=10111111”，此时标签1、2、3进行响应。
4. 第二次选择代：阅读器检测到冲突后限定更小的范围，即请求限制“<=10101111”，此时只有标签2可以响应。

# 编码与调制

## 信源编码方法

这里要介绍的四种编码方式分别为非归零编码（NRZ）、曼彻斯特编码、密勒编码和修正米勒编码。

<img src="https://chuantaoli.oss-cn-beijing.aliyuncs.com/image-20240617193527217.png" alt="image-20240617193527217" style="zoom:33%;" />

#### 图4 四种编码方式

1. 非归零编码：高1低0，编码容易实现，但没有检错功能，且无法判断一个码元的开始和结束，以至于收发双方难以保持同步。**比如，发了一长串相同的电平，就无法看出1或0的个数了。**
2. 曼彻斯特编码：将一个码元分成两个相等的间隔，前一个间隔为低电平后一个间隔为高电平表示码元1；码元0则正好相反。**可以记忆为：前高后低表示1，前低后高表示0**。也可以采用相反的规定该编码的特点是在每一个码元的中间出现电平跳变，位中间的跳变既作时钟信号（可用于同步）又作数据信号，但它**所占的频带宽度是原始的基带宽度的两倍**。每一个码元都被调成两个电平，所以**数据传输速率只有调制速率的二分之一**。
3. 密勒编码：对于原始符号“1”，**用码元起始不跳变而中心点出现跳变来表示**，即用10或01表示；对于原始符号“0”，则分成单个“0”还是连续“0”予以不同的处理：**单个“0”时，保持“0”前的电平不变，即在码元边界处电平不跳变，在码元中间点电平也不跳变对于连续两个“0”，则使连续两个“0”的边界处发生电平跳变。**
4. 修正密勒编码：每位数据**中间有个窄脉冲表示“1”**，**数据中间没有窄脉冲表示“0”**。当有连续的“0”时，从第二个“0”开始**在数据的起始部分增加一个窄脉冲。**该标准还规定**起始位的开始处也有一个窄脉冲**，而结束位用“0”表示。如果有两个连续的位开始和中间部分都没有窄脉冲，则表示无信息。

## 差错控制编码

### 奇偶校验法

在前面增加1位校验元，信息元的个数就是n-1位。对于奇校验码而言，使得“1”的个数为奇数；对于偶校验码而言，使得“1”的个数为偶数。如果接收方发现规则相同，那么就认为“没问题”。

以偶校验为例，事实上，如果序列“0101001”增加了校验码“1”成为序列“10101001”，最终传输过去的序列为“00001001”，“1”的个数仍然为偶数个，这样也是检验不出来的。

### 循环冗余校验

1. 首先准备待传送的有效数据，切割成等长的分组。

   ​	每个组都加上冗余码构成帧再发送：双方商定r+1位的生成多项式，**d位数据和r位0**组成一个序列，跟**生成多项式**进行模2除法（异或），得到的余数就是**r位FCS帧校验序列**，最终发送的帧就是**d位数据和r位FCS**组成的序列。

   ​	最后进行接收方检验：（d+r）位的数据和生成多项式进行模2除法，如果余数为0，则认为正确接收；如果余数不为0，则丢弃。

![image-20240618160815217](https://chuantaoli.oss-cn-beijing.aliyuncs.com/image-20240618160815217.png)

#### 图5 CRC循环冗余码

> 要发送的数据是1101011011，采用CRC校验，生成多项式是10011，那么最终发送的数据应该是什么？

最终发送的数据是：要发送的数据+帧检验序列FCS

计算冗余码：

1. 加0：生成多项式是10011，表示成多项式为：$x^{4}+x^{1}+1$，阶为4，则加4个0。
2. 模2除法：数据加0后是“11010110110000”除以生成多项式“10011”（异或），商为“1100001”，余数为“1110”。
3. 得到的余数“1110”即为冗余码，也成为FCS检验序列，故最终发送的数据为“1101011011**1110**”

![image-20240611152811537](https://chuantaoli.oss-cn-beijing.aliyuncs.com/image-20240611152811537.png)

#### 图6 题目计算过程

接收端检错过程：

1. 把收到的每一个帧都除以同样的除数，然后检查得到的余数R。
2. 余数为0就判断没有错，不为0就判定有错，丢弃。

在数据链路层仅仅使用循环冗余检验CRC差错检测技术，只能做到对的无差错接收，即“凡是接收端数据链路层接受的帧，我们都能以非常接近于1的概率认为这些帧在传输过程中没有产生差错”。接收端丢弃的帧虽然曾收到了，但是最终还是因为有差错被丢。“**凡是接收端数据链路层接收的帧均无差错**”。

### 海明码

纠错编码相对于检错编码可以实现发现错误、找到位置和纠正错误。

两个合法编码(码字)的对应比特取值不同的比特数称为这两个码字的**海明距离(**码距)，一个有效编码集中,任意两个合法编码(码字)的海明距离的最小值称为该编码集的海明距离(码距)。

比如，“000”和“001”的海明编码为1；“000”、“001”、“010”、“011”的海明距离也是1，任意两个编码码距的**最小值**。

**如果需要检测出$d$位错误的话，码距需要$d+1$位，如果需要纠正d位错误的话，码距需要$2d+1$位。**

![image-20240618160826914](https://chuantaoli.oss-cn-beijing.aliyuncs.com/image-20240618160826914.png)

#### 图7 海明码工作流程

1. 确定校验码位数$r$

   ​	数据/信息有$m$位，冗余码/校验码有$r$位，那么校验码一共有$2^{r}$种取值，根据海明不等式$2^{r}\geq m+r+1$。

   ​	例如，要发送的数据是“D=1100”，数据的位数$m=4$，满足不等式的最小$r$为3，也就是“D=1100”的海明码应该有$4+3=7$位，其中原数据4位，校验码3位。

2. 确定校验码和数据的位置

   ​	校验码放在序号位$2^{n}$的位置，数据按序列填上。用二进制表示序号，校验码对应位置上二进制可转换成“x1x”、“1xx”的形式，即为校验码可校验的位，如图8所示。

   <img src="https://chuantaoli.oss-cn-beijing.aliyuncs.com/image-20240611155536391.png" alt="image-20240611155536391" style="zoom: 50%;" />

   #### 图8 求出校验码的过程

   ​	以4号校验码为例，偶校验的意思是，让4、5、6、7位组成的“$x_4011$”出现偶数个1，因此$x_4$为0。因此，可以写出完整的海明码。

3. 检错并纠错

   ​	假设接收方收到的数据为“1110001”，4号校验码负责4、5、6、7的校验：0、1、1、1，发现不对；2号校验码负责2、3、6、7的校验：0、0、1、1，发现正确；1号校验码负责1、3、5、7的校验：1、0、1、1，发现错误。**因此，接收的数据是存在错误的。**

   ​	纠错方法一：找到不满足奇/偶校验的分组取交集，并与符合校验的分组取差集。发现5和7是交集，接着取差集的结果为5，故出错的位置是第5位。

   ​	纠错方法二：把$x_4$、$x_2$、$x_1$写成矩阵的形式，然后横着进行异或，这里得到的结果是1、0、1，101对应的十进制数是5，因此是第5位发生了错误，过程如图9所示。

   <img src="https://chuantaoli.oss-cn-beijing.aliyuncs.com/image-20240611160614657.png" alt="image-20240611160614657" style="zoom:50%;" />

   #### 图9 纠错方法二过程示意图

## 系统调制方法

1. 振幅键控（ASK）：ASK通过改变载波的**幅度**来表示不同的二进制位。假设“1”用高幅度表示，“0”用低幅度表示。用正弦波表示载波信号。
2. 移频键控（FSK）：FSK通过改变载波的**频率**来表示不同的二进制位。假设“1”用高频率表示，“0”用低频率表示。用正弦波表示载波信号。
3. 移相键控（PSK）：PSK通过改变载波的**相位**来表示不同的二进制位。假设“1”用0度相位表示，“0”用180度相位表示。用正弦波表示载波信号。

<img src="https://chuantaoli.oss-cn-beijing.aliyuncs.com/image-20240618160853119.png" alt="image-20240618160853119" style="zoom: 50%;" />

#### 图10 数据“11010”的三种调制方法

# 典型电子标签S50卡

## 工作流程

<img src="https://chuantaoli.oss-cn-beijing.aliyuncs.com/image-20240618161241220.png" alt="image-20240618161241220" style="zoom:50%;" />

#### 图11 S50卡工作流程图

​	S50卡对存储器的操作：

1. READ 读块：读存储器的一个分组（数值块）。
2. WRITE 写块：写存储器的一个分组（数值块）。
3. INCREMENT 加值：增加存储器中一个分组的内容（数值块内的值），并将结果存入数据寄存器。这通常用于计数或增加某个值。
4. DECREMENT 减值：减少存储器中一个分组的内容（数值块内的值），并将结果存入数据寄存器。这用于减去某个值，类似于加值操作的逆操作。
5. TRANSFER 转存：将数据寄存器中的内容写入EEPROM的一个分组。此操作用于将暂存的数据存入EEPROM中，确保数据的持久化。
6. RESTORE 恢复：将存储器中一个分组的内容恢复到数据寄存器。这通常用于从EEPROM恢复某个分组的数据，以便进行进一步的处理。

​	工作流程的步骤：

1. 卡呼叫：开始流程，通过防冲突循环获取卡号。
2. 选卡（激活）：选择并激活卡片。
3. 三轮认证（对指定扇区）：对指定扇区进行三轮认证以确保安全性。
4. 切换扇区/不切换扇区：根据需要选择是否切换扇区。
   - 不切换扇区：执行读块、写块、加值、减值、恢复操作，最后进行转存。
   - 切换扇区：返回进行三轮认证。

## 三次认证过程

1. 阅读器**发送查询口令**的命令给应答器，应答器**作为应答响应传送所产生的一个随机数RB**给阅读器。
2. 阅读器**产生一个随机数RA**，使用共享的密钥K和共同的加密算法EK，**算出加密数据块TOKEN AB**，并将TOKEN AB传送给应答器，TOKEN AB＝EK(RA,RB) 。
3. 应答器接受到TOKEN AB后，进行解密，将取得的随机数与原先发送的随机数RB进行比较，**若一致，则阅读器获得了应答器的确认**。
4. 应答器发送另一个加密数据块TOKEN BA给阅读器，TOKEN BA＝EK(RB1,RA)。
5. 阅读器接收到TOKEN BA并对其解密，**若收到的随机数与原先发送的随机数RA相同，则完成了阅读器对应答器的认证**。

## 标签存储结构

<img src="https://chuantaoli.oss-cn-beijing.aliyuncs.com/image-20240618161353828.png" alt="image-20240618161353828" style="zoom:50%;" />

#### 图12 标签存储器逻辑映射

1. 每个扇区由4块（块0、块1、块2、块3）组成（也有的将16个区的64个块按绝对地址编号为0～63）。
2. 第0扇区的块0（即绝对地址0块）都是一个特殊的块，该块存储了制造商代码，已经固化，不可更改。
3. 每个扇区的块0、块1、块2为数据块，用于存储数据，可以进行读写操作。
4. 每个区的块3为控制块，包括了密钥A、访问控制条件、密钥B。

<img src="https://chuantaoli.oss-cn-beijing.aliyuncs.com/image-20240618161400797.png" alt="image-20240618161400797" style="zoom:50%;" />

#### 图13 控制块的具体结构

1. 密钥A有6字节，访问控制条件有4字节，密钥B有6字节。
2. 由于每个区都有各自的密钥和访问条件，各区之间互不干扰，因此Mifare S50可作为多功能卡使用。
3. 每个区的密钥和访问控制条 件相互独立，可以根据实际 需要设定各自的密钥及访问控制条件。

> 已知存储控制字节为**37 85 ac 69**请写出每个块的存取控制位，并表述块0和块1的访问控制条件。

控制字节对应的二进制码为：

|           | **7** | **6** | **5** | **4** | **3** | **2** | **1** | **0** |
| --------- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- |
| **Byte6** | **0** | **0** | **1** | **1** | **0** | **1** | **1** | **1** |
| **Byte7** | **1** | **0** | **0** | **0** | **0** | **1** | **0** | **1** |
| **Byte8** | **1** | **0** | **1** | **0** | **1** | **1** | **0** | **0** |
| **Byte9** | **0** | **1** | **1** | **0** | **1** | **0** | **0** | **1** |

上表中就是把十六进制的控制字节转换成二进制即可。

Byte 6、Byte 7 和 Byte 8用于指定每个块（Block）的访问条件，而Byte 9是校验字节，确保前三个字节的正确性。具体的访问控制规则由下表定义：

![image-20240618162247484](https://chuantaoli.oss-cn-beijing.aliyuncs.com/image-20240618162247484.png)

#### 图14 访问控制规则

1. 确定各块的控制位。访问控制条件的定义可以用顺口溜记忆为**687，反正反，0123**。
2. 写出每个块对应的控制位：块0是000，块1是001，块2是010，块3是111。
3. 查找控制条件：块0验证密钥A或B正确后可读可写可加值可减值可转存可恢复。块1验证密钥A或B正确可读不可写不可加值，验证密钥A或B正确可减值可转存可恢复。

# RFID基本概念

## 简述RFID工作流程（以无源标签为例）

1) 读写器通过天线发送一定频率的射频信号。
2) 电子标签天线产生足够的感应电流，电子标签获得能量被激活。
3) 电子标签将信息通过内置天线发送出去。
4) 读写器天线接收到从电子标签发送来的无线射频信号。
5) 读写器天线将无线射频信号传送到读写器。
6) 读写器对无线射频信号进行解调和解码，送到系统高层进行相关处理。
7) 系统高层根据逻辑运算判断该电子标签的合法性。
8) 系统高层针对不同的设定做出相应的处理，发出指令信号，控制执行机构的动作。

## RFID常用的工作频率

![image-20240618164423751](https://chuantaoli.oss-cn-beijing.aliyuncs.com/image-20240618164423751.png)

#### 图15 RFID常用的工作频率

1. 低频：

   ​	**低频RFID系统的工作频率为30～300 kHz，采用电磁感应方式来进行通信。低频信号穿透性好，抗金属和液体干扰能力强，但难以屏蔽外界的低频干扰信号。**

   ​	一般来说，低频RFID标签读取距离短于10 cm，读取距离跟标签大小成正比。

   ​	低频RFID标签一般在出厂时就初始化好了不可更改的编码，不过一些低频标签也加入了写入和防碰撞功能。

   ​	**低频标签主要应用在动物追踪与识别、门禁管理、汽车流通管理、POS系统和其他封闭式追踪系统中。**

   ​	常用的低频标签一般具有以下性能：

   1. 通常都是近距离标签，距离为10 cm以下。

   2. 主要应用于短距离、数据量低的射频识别系统中。

   3. 价格很低，成本低廉。

   4. 一般为只读性，安全性不高，很容易复制完全相同的ID号，所以此类卡片一般用在安全性和成本要求不高的场合。

2. 高频：

   ​	**高频系统的工作频率为3～30 MHz，**射频识别常见的高频工作频率有6.75 MHz、13.56 MHz和27.125 MHz。

   ​	高频系统也采用电磁感应方式来进行通信，具有良好的抗金属与液体干扰的性能，读取距离大多在1 m以内。

   ​	高频RFID标签传输速度较高，但抗噪声干扰性较差，一般具备读写与防冲突功能。现在高频RFID标签是RFID领域中应用最广泛的，如证、卡、票领域（二代身份证、公共交通卡、门票等），其他的应用还包括供应链的个别物品追踪、门禁管理、图书馆、医药产业、智能货架等。

3. 超高频：

   ​	**被动式超高频RFID标签工作频率为860～960 MHz，主动式超高频RFID标签则工作在433 MHz。**

   ​	在超高频频段，各个国家都有自己规定的频率，**我国一般以915 MHz为主。**

   ​	超高频的优点就是距离远，最远可以达到15 m。超**高频RFID标签传输距离远，具备防碰撞性能，并且具有锁定与消除标签的功能。**

   ​	被动式超高频RFID标签有分别支持近场通信与远场通信两种。远场被动式UHF采用反向散射耦合方式进行通信，可以用蚀刻、印刷等工艺制作成不同的样式，其最大的优点是读写距离远，一般是3～5 m，最远可达10 m，但是由于**抗金属与液体性差，所以较少用于单一物品的识别，主要应用于以箱或者托盘为单位的追踪管理、行李追踪、资产管理和防盗等场合。**

   ​	近场被动式UHF通信使用的天线与HF相类似，但线圈数量只需要一圈，而且采用的是电磁感应方式而非反向散射耦合方式，也具备HF的抗金属液体干扰的优点，其缺点是读取距离短，约为5 cm，近场UHF通信主要应用于单一物品识别追踪，以取代目前HF的应用。

4. 微波：

   ​	**微波RFID标签的主要工作频率为2.45 GHz，有些则为5.8 GHz，因为工作频率高，所以在各种频段的RFID标签中传输速度最大，但是抗金属液体能力最差。**

   ​	被动式微波RFID标签主要使用反向散射耦合方式进行通信，传输距离较远，如果要加大传输距离还可以改为主动式。由于传输速度快，微波RFID标签非常适合用于高速公路等收费系统。

## **自动识别技术**

自动识别通常是指采用机器进行识别的技术，其目的是提供个人、动物、货物、商品和图文等信息。

自动识别技术包括条形码、生物特征识别（具体的人脸识别、指纹识别等都给分）、射频识别。

## 二维码会不会取代RFID

二维码与一维条码一样，几乎是零成本的信息存储技术。

1. 二维码主要是通过将信息通过一定的算法转化成计算机容易识别的特殊图形，将这样的特殊图形在打印到物品上，因为打印或印刷一个特殊图形的成本仅仅在于标签本身的价值，所以成本接近零。
2. RFID技术在推广和使用上的瓶颈源于它的成本较高，对于一般的小商品而言，电子标签的价格要高于商品本身价格很多，因此一般的厂商或销售商都难以承受。目前，虽然采用了多种办法来降低标签的成本，但真正达到要让普通大众接受的价格，还需要很长的时间。

其次，从应用上来看，二维码在商品上使用，必须要通过扫码设备才能读取数据，如果要处理的商品较多，每个商品的二维码都要通过扫码设备才能读取信息。假如在大型仓库进行盘点，工人不得不拿着扫码设备爬上爬下的去找每个商品的二维码，费时费力。但是，在这方面，RFID就表现出很突出的优势，如果每个商品都装有RFID标签的话，那么工人只需在办公室里读取读写器上的数据就可以了，省时省力。

通过以上的比较，可以看出每种自动识别的技术都有一定应用优势和局限性，多种技术共存可以充分发挥它们的优势而且可以互相拟补它们的缺点。根据不同的使用环境和技术条件，结合被使用对象的特点，我们可以采用不同的识别技术。比如：目前RFID技术在车联网中有较出色的应用，而在移动电子商务中，二维码也已经取得不错的成绩。善用这些识别技术，能为我们的生产效率和生活水平带来很大的改变。尽早实现生活的“智能化”。

## 读写器的基本概念

### 读写器的基本功能

1. 给电子标签提供能量。
2. 实现与电子标签的通信。
3. 实现与计算机通信。
4. 实现多个电子标签的识别。
5. 实现移动目标识别。
6. 数据记录功能。

### 读写器的工作流程

射频标签读写设备均遵循如图16的信息处理与控制模式，读写器与射频标签（数据载体）之间通过空间信道实现读写器向射频标签发送指令，射频标签接收读写器的指令后作出必要的响应，由此实现了射频识别功能。

<img src="https://chuantaoli.oss-cn-beijing.aliyuncs.com/image-20240619123930026.png" alt="image-20240619123930026" style="zoom:33%;" />

#### 图16 读写器信息处理与控制模式

### 读写器的基本构成

<img src="https://chuantaoli.oss-cn-beijing.aliyuncs.com/image-20240619130703897.png" alt="image-20240619130703897" style="zoom:33%;" />

#### 图17 读写器的基本构成

1. 射频模块：由射频振荡器产生射频能量，射频能量的一部分用于读写器，另一部分通过天线发送给电子标签，激活无源电子标签并为其提供能量；将发送给电子标签的信号调制到读写器载频信号上，形成已调制的发射信号，经读写器天线发射出去；将电子标签返回给读写器的回波信号解调，提取出电子标签发送的信号，并将电子标签信号进行放大处理。
2. 逻辑控制模块：对读写器和电子标签的身份进行验证；控制读写器与电子标签之间的通信过程；对读写器与电子标签之间传送的数据进行加密和解密；实现与后端应用程序之间的接口规范；执行防碰撞算法，实现多标签识别功能。
3. 天线模块：读写器天线的作用是发射电磁能量以激活电子标签，并向电子标签发出指令，同时也要接收来自电子标签的信息。读写器天线所形成的电磁场范围就是RFID系统的可读区域。任意RFID系统至少应该包含一根天线，用来发射或接收射频信号，所采用的天线的形式及数量应视具体应用而定。需要满足以下基本条件：
   1. 天线线圈的电流最大，用于产生最大的磁通量。
   2. 功率匹配，以最大程度地利用磁通量的可用能量。
   3. 足够的带宽，保证载波信号的传输，这些信号是用数字信号调制而成的。
   4. 要求低剖面、小型化，读写器由于结构、安装和使用环境等变化多样，读写器产品正朝着小型化方向发展。

## 标签与电子标签

### 磁卡

磁卡是将具有信息存储功能的特殊材料涂印在塑料基片上，以液体磁性材料或磁条为信息载体，将宽6～14 mm的磁条压贴在卡片上制作而成。磁条上有三条磁道，前两条磁道为只读磁道，第三条磁道为读写磁道。

磁卡的信息读写相对简单容易，使用方便，成本低。并很快进入了多个应用领域。相当部分的信用卡由磁卡制成。

### 智能卡

智能卡又称为集成电路卡（IC卡），内部带有微处理器和存储单元等部件。IC卡的芯片具有写入和存储数据的能力，IC卡存储器中的内容可以根据需要有条件地供外部读取，或供内部信息处理和判定之用。

IC卡是超大规模集成电路技术、计算机技术以及信息安全技术等发展结合的产物，它将集成电路芯片镶嵌于塑料基片的指定位置上，可保存、读取和修改芯片上的信息。在很多领域中，磁卡正在被大量的IC卡所代替。

1. 接触式IC卡

   ​	接触式IC卡接口设备总体结构框图如图所示，芯片金属触点暴露在外，该触点直接接入IC卡接口设备的IC卡适配器插座，实现与IC卡中的集成电路进行信息处理和交互。

   <img src="https://chuantaoli.oss-cn-beijing.aliyuncs.com/image-20240619131322288.png" alt="image-20240619131322288" style="zoom:33%;" />

   #### 图18 接触式IC卡接口设备总体结构框图

2. 非接触式IC卡

   ​	非接触式IC卡的芯片全部封于卡内，无暴露部分。此外，在卡内还嵌有一个微型天线，以便嵌入的芯片与读卡器之间非接触的相互通信。它通过无线电波或电磁场感应来交换信息，成功地将射频识别技术和IC技术结合起来，解决了无源（卡中无电源）和非接触这两大难题，是电子器件领域的一重大突破。

   ​	与接触式IC卡比较，非接触式IC卡具有以下优点：

   1. 可靠性高：它与读写器之间无机械接触，避免了由于接触读写而产生的各种故障，如接触不良、粗暴插卡、芯片脱落、被击穿、弯曲损坏等。
   2. 操作方便、迅速：由于非接触通信，读写器在10 cm范围内可以对卡片操作，非常方便用户的使用且能提高效率。
   3. 防碰撞：非接触卡中有快速防碰撞机制，能防止卡片之间出现数据干扰，因此可以对多张卡进行并行处理，提高系统速度。
   4. 可以适合于多种应用：该卡的存储结构特点使它能够实现一卡多用，通过密码和访问条件的设定，就能应用于不同的系统。
   5. 加密性能好：非接触式IC卡的序列号是唯一的，由制造厂家固化而不可更改。卡中各扇区都有自己的操作密码和访问条件，卡与读写器之间采用双向验证机制，而且通信过程中所有数据都加密，所以它很适合电子钱包、公路自动收费系统和公交自动售票系统等应用。

### 电子标签类别

1. 存储器标签：存储器标签的内部结构如下图所示。这种芯片的特点是没有微处理器单元，由地址和安全逻辑单元进行数据处理和访存操作。存储器包含有电可擦写可编程只读存储器（EEPROM）和只读存储器（ROM）。电子标签接收到的高频调制信号，在高频接口进行解调后经地址和安全逻辑单元进一步处理，或者进行访问存储器的操作。存储器标签存储方便、使用简单、价格便宜，在很多场合可以替代磁卡，如医疗上用的急救卡、餐饮业的客户菜单卡等。

   <img src="https://chuantaoli.oss-cn-beijing.aliyuncs.com/image-20240619131530526.png" alt="image-20240619131530526" style="zoom:33%;" />

   #### 图19 存储器标签

2. 微处理器标签：微处理器电子标签中的集成电路包括中央处理器（CPU）、EEPROM、随机存储器（RAM）以及固化在只读存储器中的片内操作系统（COS）。COS用来控制命令序列、文件管理及执行加密算法等。如果收到有效命令，则执行与此应用命令有关的程序代码；如果需要访问EEPROM中的应用数据，则由文件管理系统和存储器专门执行。CPU卡的CPU一般为8031/51系列单片机的内核，也有采用其他内核的。这种卡进行密码校验时，密码是不以明文出现在通信线上。CPU卡适用于保密性要求高的场合，如金融卡、军事密令卡等。

   <img src="https://chuantaoli.oss-cn-beijing.aliyuncs.com/image-20240619131631058.png" alt="image-20240619131631058" style="zoom:33%;" />

   #### 图20 微处理器标签

3. 主动式标签：具有内部电源供应器，用以供应芯片所需电能以产生对外的信号。一般来说，主动式标签读取距离比较长，可以达到几十米甚至上百米，但是存在寿命有限、体积较大以及成本较高等缺陷。有源标签一般在集装箱的电子标签中应用比较多。

4. 被动式标签：内部没有供电电源。当无源电子标签进入读写器的工作区域后，受到读写器发出射频信号的激励，前提是要求电子标签与读写器在一定的距离内，读写器能提供电子标签足够的射频场强，从而保证标签进入正常工作状态。由于被动式标签具有价格低廉，体积小巧，无须电源的优点，目前市场的RFID标签主要是被动式的。

   <img src="https://chuantaoli.oss-cn-beijing.aliyuncs.com/image-20240619131747753.png" alt="image-20240619131747753" style="zoom:33%;" />

   #### 图21 主动式标签与被动式标签的对比

5. 只读电子标签：这是最简单的标签，它的内部通常只有只读存储器（ROM）来存储标识信息（ID），且ID是在制造过程中写入的，此后不可更改。只读电子标签也可用来做成电子防盗器的标签，甚至可以没有ID号，它们在通过读写器的时候，能被读写器监测到。

6. 一次写入只读电子标签：这种标签内部只有ROM和RAM。ROM用于存储系统程序和安全性要求高的数据，它与内部的处理器或逻辑处理单元共同完成内部的操作控制功能。只读电子标签的ROM中还存储了标签的标识信息（ID）,这些信息在标签制造过程中由制造商写入，也可以由用户自己写入，但是一旦写入之后就不能修改了。

7. 读写电子标签：这是一种非常灵活的标签，用户可以对标签的存储器进行读写操作。它的内部含有可编程记忆存储器，这种存储器除了有存储信息的功能外，还可以在适当的条件下由用户写入数据。例，EEPROM就是比较常见的一种，这种存储器可以在加电的情况下，实现对原来数据的擦除和数据的重新写入。

8. 含有片上传感器的可读写电子标签：这种标签包含有一个片上传感器，用户可以用来记录参数（如温度、压力、加速度等），并将其写入标签存储器（通常是可编程记忆存储器，如EEPROM）。因为这种标签的工作环境并不在读写器的工作范围之内，因此必须是主动式或者半主动式。

9. 含有收发信机的可读写电子标签：这种标签类似于一个小的发射接收系统，可以和其他标签或器件进行数据通信，而无须读写器的参与，并可以把相关信息通过可编程的方式写入到自身的可编程存储器中，它们通常是主动式的。

### 电子标签结构组成

1. 天线：电子标签天线主要功能是接收读写器传送过来的电磁信号或者将读写器所需要的数据传回给读写器，电子标签天线是电子标签与读写器之间取得联系的重要一环。天线的尺寸要比芯片大很多。对于线圈型天线而言，如果要求线圈外形面积小，**通常在电子标签的天线线圈内部插入具有高磁导率的铁氧体材料，以增大互感量，从而补偿线圈横截面积减小的问题**。

   <img src="https://chuantaoli.oss-cn-beijing.aliyuncs.com/image-20240619132031321.png" alt="image-20240619132031321" style="zoom:33%;" />

   #### 图22 线圈型天线

2. 微带贴片天线：微带贴片天线结构如图所示，通常，微带贴片天线的辐射导体与金属地板的距离为几十分之一信号波长，假设辐射电场沿导体的横向与纵向两个方向均没有变化，仅沿约半个波长的导体长度方向有变化，因此微带贴片天线非常适用于通信方向变化不大的RFID应用系统。

3. 偶极子天线：在远距离耦合的RFID应用系统中，最常用的就是偶极子天线。偶极子天线由两段同样粗细和等长的直导线排成一条直线构成，信号从中间的两个端点馈入，在偶极子的两臂上将产生一定的电流分布，这种电流分布可以在天线周围空间激发起电磁场。偶极子天线及其演化形式如图23所示.

   <img src="https://chuantaoli.oss-cn-beijing.aliyuncs.com/image-20240619132312574.png" alt="image-20240619132312574" style="zoom:33%;" />

   #### 图23 偶极子天线及其演化形式

### 芯片

电子标签芯片对接收的信号进行解调、解码等各种处理，并对标签需要返回的信号进行编码、调制等处理。不同频段电子标签芯片的结构基本类似，一般包含射频前端/模拟前端、CPU或逻辑控制单元、存储器等模块。

1. 射频前端主要用于对射频信号进行整流和反向调制。
2. CPU主要用于对数字信号进行编码解码以及防碰撞协议的处理等。
3. 存储器用于信息存储，包含RAM、EEPROM等。

数字基带信号必须经过高频信号调制才能传输，该高频信号称之为载波。在发送端，将基带数字信号转换成高频信号的过程称为调制。在接收端，将高频信号转换成基带数字信号的过程称为解调。实现数据传输的电路称为射频接口。

# RFID的应用

## RFID在智能交通领域的应用

不停车电子收费（ETC）是目前世界上最先进的路桥收费方式，通过安装在车辆挡风玻璃上的车载电子标签与在收费站ETC车道上的阅读器之间实现微波通信，结合计算机联网技术与银行进行后台结算处理，从而实现车辆通过路桥收费站不需停车而自动缴费。

车道管理系统主要由车俩识别子系统、道闸实时控制子系统和RFID子系统构成，各子系统的作用如下：

1. 车辆识别系统：识别车俩牌号，一是对车俩进行识别和记录，二是和RFID电子芯片中的信息进行对比，比如车俩的高度等数据。
2. 道闸实时控制系统：控制整个关卡的禁行和放行，一般由可控的栏杆和电感线圈组成。
3. RFID子系统：完成对车载电子芯片的读写操作，并将数据传输到收费管理中心。

ETC系统的工作流程如下：

1. 车主办理ETC通行以及网上银行业务。车主到高速公路管理部门**购置RFID电子标签**，**由发行系统向RFID电子标签输入车辆识别码**，并在数据库中存入该车辆的全部有关信息，并在系统中登记用户的扣费账号。
2. 车辆信息入库。发行系统将上述车主、车辆信息输入收费计算机系统，**RFID电子标签贴在车上相应的部位**，可以立即使用。
3. 收费站ETC通道入口写信息。当车辆经过高速公路ETC通道入口时，**该站的收费系统的RFID读写器发出射频信号**，由RFID电子标签的天线接收射频信号，激活RFID电子标签后，该RFID读写器**同时还向RFID电子标签写入入口信息**。写入信息也由电子标签的天线接收，写入RFID电子标签芯片中。
4. 收费站ETC通道出口读信息。当车辆通过高速公路ETC通道出口时，该站的收费系统的RFID阅读器发出射频信号，由RFID电子标签的天线接收射频信号，激活RFID电子标签后，**RFID读写器读出RFID电子标签中存储的信息**。
5. 车辆放行处理。收费计算机系统向执行机构输出执行信号。当网上银行的储值，即**结余金额足够支付过站的费用时**，出站口绿灯亮，给予放行；若结余金额已不多，**处于警告值以下**，则黄灯亮，提示车主应再购买储值，但仍予以放行；**若结余金额不足或已无余款**，则红灯亮，不予放行。
6. 收费完成。上述过程均可以在瞬时完成，因此ETC系统可保证车辆高速通过收费站，**收费计算机系统将通过该站的车辆识别码及其新储值等信息，经通信网络送至有关中心与其他收费系统中**。

## RFID在食品安全领域的应用

​	RFUD技术的使用就像给食品制作一个标记，记录了食品供应链各个阶段的信息。RFID在食品链中的应用如下所示：

1. 在食品或原材料源头加入RFID标签，写入食品或原材料的基本信息，如生产地、生产日期、储存方式及食用方法。
2. 加工厂完成食品加工，将原料和辅料的原始记录以及加工过程信息写入RFID标签。
3. 将仓储、运输、分销和配送等物流环节的信息写入RFID标签。
4. 到达超市、农贸市场、餐饮和快餐等终端后，再将这一层信息写入RFID标签实现跟踪链的最后环节。
5. 消费者在食品消费时可以通过终端进行相关信息的查询和确认。

## RFID在智能医护领域的应用

基于RFID的智能医护系统实现对病人的自动身份识别、病人安全管理、生命体征信息自动采集监视、病房管理等新型医务服务和管理功能，每个子系统如下所示：

1. 病人身份识别系统：病人在入院时即通过入院注册系统登记身份信息，并佩戴电子标签腕带。对于有源RFID标签，病人通过佩戴的电子腕带标签发出的信息能够随时被覆盖的无线RFID探测网络侦测到，由医护工作人员通过工作台的电脑就可以随时识别到不同位置的病人身份信息。若采用无源电子标签为载体，则可以由手持读写器显示读取标签的身份信息，通过移动标签工作站来检查比对标签身份的准确性。
1. 病人安全管理系统：病人佩戴的电子腕带在病房监护区域收到阅读器（RFID探测器）的监测，通过电子报警可以防止被非法去除或剪断，并通过位置跟踪、报警和出入控制可以防止病人未经允许离开监护区域。病人佩戴的RFID腕带中设置了相关的活动区域信息，腕带采用专门的锁扣结构，一旦戴上就无法正常解下来，直到病人出院才会被剪断回收。
1. 病人实时定位监视系统：通过RFID探测系统网络，佩戴腕带的病人在网络区域内的位置将实时反映到护士监控工作台的电脑上，使工作人员能够随时了解病人活动的去向，对未经许可的活动区域及时提示报警。
1. 病人生命体征数据采集和监护系统：利用RFID物联网技术结合体征测量仪器，使病人能够通过佩戴RFID体温探头、移动式监护仪等设备在线自动采集病人的相关体征数据，实时提供医护病人的体征状态信息，及时通过提醒异常状况的发送，为病人提供更好的医护关怀。
1. 病房管理系统：利用RFID移动工作站可现场识别患者身份，记录护理工作内容，查看患者实时状态。护理人员在进行日常病房巡查时，利用移动终端可以随时查阅住院病人的护理事项、查看工作计划、登记核对工作完成情况以及添加患者的相关护理项目信息。

## RFID在票券防伪领域的应用

票务防伪系统由中央数据库管理子系统（数据中心）、制票售票系统、验票查票系统等模块组成，除需配备常规的计算机网络系统设施外，还需配备门票发行设备、门票检票设备和RFID电子门票。

1. 数据中心：由数据库服务器和管理终端组成，是系统的数据中心，对票务管理信息、售票和检票信息进行集中存储和处理。
2. 制票售票系统：由售票管理终端、标签发行和打印终端组成，完成电子标签门票的统一制作、售出，以及真伪的鉴别等功能。
3. 检票查票系统：检票员在观众入场时可通过手持机鉴别门票的真伪、合法的观众名单，以及入场和门票鉴别信息，并通过上位机与管理中心进行数据的上传和下载。
4. 票务防伪管理系统软件部分：由发行端软件和含有RFID电子标签的入场券组成，由于标签的只读特性，真正实现每张入场券被赋予一个唯一的识别码。
